<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>강화 아이템 정보</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Nanum+Gothic+Coding&family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">

    <style>
        .header {
            padding: 20px;
            background-color: rgb(249, 249, 249);
            border: 1px solid #ccc;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            font-family: "Noto Sans KR", sans-serif;
            font-size: x-large;
            font-weight: bold;
            top: 0;
        }

        button,
        .btn-primary {
            padding: 10px 20px;
            background-color: blue;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        button:hover,
        .btn-primary:hover {
            background-color: rgb(22, 22, 97);
        }

        .nav {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .nav a {
            padding: 10px 20px;
            background-color: blue;
            color: rgb(0, 0, 0);
            text-decoration: none;
            border-radius: 5px;
        }

        .nav a:hover {
            background-color: rgb(22, 22, 97);
        }

        #GG {
            width: 200px;
            height: 80px;
            margin: 20px 30px 20px 30px;
            margin-left: 10px;
            text-align: center;
            line-height: 50px;
            background-color: blue;
            color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-decoration: none;
            line-height: 60px;
            font-family: "Noto Sans KR", sans-serif;
            font-size: x-large;
            font-weight: bold;
        }

        #DD {
            width: 200px;
            height: 80px;
            margin: 20px 40px 20px 40px;
            margin-left: 120px;
            text-align: center;
            line-height: 50px;
            background-color: blue;
            color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-decoration: none;
            line-height: 60px;
            font-family: "Noto Sans KR", sans-serif;
            font-size: x-large;
            font-weight: bold;
        }

        body {
            font-family: "Noto Sans KR", sans-serif;
            font-size: x-large;
            font-weight: bold;
            background-color: rgb(249, 249, 249);
        }

        .container,
        #dexPageId {
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 40px;
            margin-bottom: 20px;
        }

        .item-image-container {
            position: relative;
            width: 30%;
            padding-top: 30%;
            overflow: hidden;
            border-radius: 10px;
            background-color: rgb(249, 249, 249);
            margin: 0 auto;
            max-height: calc(100vh - 80px);
        }

        .item-image {
            width: 250px;
            height: 250px;
            object-fit: contain;
            margin: 0 auto;
            display: block;
        }

        .item-title {
            margin-left: 230px;
            font-family: "Noto Sans KR", sans-serif;
            font-size: x-large;
            font-weight: bold;
        }

        #enchanceRate {
            margin-left: 200px;
            font-family: "Noto Sans KR", sans-serif;
            font-size: x-large;
            font-weight: bold;
        }

        #successRate {
            margin-left: 190px;
            font-family: "Noto Sans KR", sans-serif;
            font-size: large;
        }

        #failureRate {
            margin-left: 190px;
            font-family: "Noto Sans KR", sans-serif;
            font-size: large;
        }

        #enhanceButton {
            margin-left: 198px;
            font-family: "Noto Sans KR", sans-serif;
            font-size: x-large;
            font-weight: bold;
        }

        .pp {
            flex-direction: column;
            margin-left: 430px;
        }

        .success-text {
            color: blue;
        }

        .failure-text {
            color: rgb(201, 61, 115);
        }

        #myform fieldset {
            display: flex;
            justify-content: center;
            direction: rtl;
            border: 0;
            text-align: center;
        }

        #myform fieldset legend {
            text-align: center;
        }

        #myform input[type=radio] {
            display: none;
        }

        #myform label {
            font-size: 1em;
            color: transparent;
            text-shadow: 0 0 0 #f0f0f0;
        }

        #myform label:hover {
            text-shadow: 0 0 0 #FFC83D;
        }

        #myform label:hover~label {
            text-shadow: 0 0 0 #FFC83D;
        }

        #myform input[type=radio]:checked~label {
            text-shadow: 0 0 0 #FFC83D;
        }

        .footer {
            padding: 20px;
            background-color: rgb(249, 249, 249);
            border: 1px solid #ccc;
            border-radius: 10px;
        }

        #average-rating {
            text-align: center;
        }

        .footer h3 {
            font-size: 29px;
            color: #333;
            margin-bottom: 10px;
            margin-left: 46%;
            font-family: "Noto Sans KR", sans-serif;
            font-weight: bold;
        }

        .rating-form-table {
            width: 100%;
        }

        .rating-form-table input[type="text"] {
            width: 25%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .rating-form-table textarea {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            resize: none;
            height: 100px;
        }

        .rating-form-table textarea {
            height: 100px;
        }

        .rating-form-table button[type="button"] {
            padding: 10px 20px;
            background-color: blue;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        .rating-form-table button[type="button"]:hover {
            background-color: rgb(22, 22, 97);
        }

        #comments-list {
            list-style: none;
            padding: 0;
            margin-top: 20px;
        }

        #comments-list li {
            border: 1px solid #ccc;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        }

        #comments-list li span.comment-name {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        #comments-list li span.comment-time {
            color: #666;
            font-size: 12px;
            display: block;
            margin-bottom: 10px;
        }

        #comments-list li span.comment-text {
            display: block;
            margin-bottom: 10px;
        }

        .delete-comment {
            padding: 5px 10px;
            background-color: blue;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        .delete-comment:hover {
            background-color: rgb(22, 22, 97);
        }

        .view-comments-btn {
            padding: 10px 20px;
            background-color: blue;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            margin-top: 10px;
        }

        .view-comments-btn:hover {
            background-color: rgb(22, 22, 97);
        }
    </style>
</head>

<body>
    <div class="header">
        <div>마비노기 영웅전 강화 성공 확률 표</div>
    </div>
    <div class="nav">
        <a id="enhancePageLink" href="#" onclick="showEnhancePage()">강화하기</a>
        <a id="dexPageLink" href="#" onclick="showDexPage()">도감</a>
    </div>
    <div class="container" id="enhancePage">
        <div class="item-image-container">
            <img src="https://cdn.ventisca.io/mabi/vs/images/1.png" alt="item image" class="item-image">
        </div>
        <h1 class="item-title">강화 할 아이템</h1>
        <p id="enchanceRate">현재 강화 수치: +<span id="enhance-level">0</span></p>
        <p id="successRate">성공 확률: <span id="success-rate">100%</span></p>
        <p id="failureRate">실패 확률: <span id="failure-rate">0%</span></p>
        <button id="enhanceButton" onclick="enhanceItem()">강화하기</button>
        <p id="result" class="pp"></p>
    </div>
    <div class="container" id="dexPageId" style="display: none;">
        <h1>도감</h1>
        <table id="dexPage" class="table table-bordered">
            <thead>
                <tr>
                    <th>아이템 이름</th>
                    <th>설명</th>
                    <th>평균 평점</th>
                    <th>리뷰</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>아이템 1</td>
                    <td>아이템 1 설명</td>
                    <td id="average-rating">4.5</td>
                    <td>
                        <button class="view-comments-btn" data-item="item1">댓글 보기</button>
                    </td>
                </tr>
            </tbody>
        </table>
        <div id="comment-section">
            <h3>댓글</h3>
            <ul id="comments-list">
                <!-- 댓글이 여기에 추가됩니다 -->
            </ul>
            <form id="myform">
                <fieldset class="rating-form-table">
                    <legend>평점을 매겨주세요:</legend>
                    <input type="radio" id="star5" name="rating" value="5"><label for="star5">★</label>
                    <input type="radio" id="star4" name="rating" value="4"><label for="star4">★</label>
                    <input type="radio" id="star3" name="rating" value="3"><label for="star3">★</label>
                    <input type="radio" id="star2" name="rating" value="2"><label for="star2">★</label>
                    <input type="radio" id="star1" name="rating" value="1"><label for="star1">★</label>
                </fieldset>
                <table class="rating-form-table">
                    <tr>
                        <td>이름:</td>
                        <td><input type="text" id="comment-name"></td>
                    </tr>
                    <tr>
                        <td>댓글:</td>
                        <td><textarea id="comment-text"></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><button type="button" onclick="submitComment()">댓글 남기기</button></td>
                    </tr>
                </table>
            </form>
        </div>
    </div>
    <div class="footer">
        <h3>현재 평균 평점: <span id="average-rating-footer">4.5</span></h3>
    </div>
    <script>
        let currentEnhanceLevel = 0;

        function enhanceItem() {
            const enhanceLevel = document.getElementById('enhance-level');
            const successRate = document.getElementById('success-rate');
            const failureRate = document.getElementById('failure-rate');
            const result = document.getElementById('result');

            const enhanceData = [
                { level: 0, successRate: 100 },
                { level: 1, successRate: 90 },
                { level: 2, successRate: 80 },
                { level: 3, successRate: 70 },
                { level: 4, successRate: 60 },
                { level: 5, successRate: 50 },
                { level: 6, successRate: 40 },
                { level: 7, successRate: 30 },
                { level: 8, successRate: 20 },
                { level: 9, successRate: 10 },
                { level: 10, successRate: 5 }
            ];

            const currentData = enhanceData[currentEnhanceLevel];
            const successProbability = currentData.successRate / 100;

            if (Math.random() < successProbability) {
                currentEnhanceLevel++;
                enhanceLevel.textContent = currentEnhanceLevel;
                result.textContent = `강화에 성공했습니다! 현재 강화 수치: +${currentEnhanceLevel}`;
                result.classList.remove('failure-text');
                result.classList.add('success-text');
            } else {
                result.textContent = `강화에 실패했습니다. 현재 강화 수치: +${currentEnhanceLevel}`;
                result.classList.remove('success-text');
                result.classList.add('failure-text');
            }

            if (currentEnhanceLevel < enhanceData.length) {
                const nextData = enhanceData[currentEnhanceLevel];
                successRate.textContent = `${nextData.successRate}%`;
                failureRate.textContent = `${100 - nextData.successRate}%`;
            } else {
                successRate.textContent = '0%';
                failureRate.textContent = '100%';
            }
        }

        function showDexPage() {
            document.getElementById('enhancePage').style.display = 'none';
            document.getElementById('dexPageId').style.display = 'block';
        }

        function showEnhancePage() {
            document.getElementById('enhancePage').style.display = 'block';
            document.getElementById('dexPageId').style.display = 'none';
        }

        const comments = [];

        function submitComment() {
            const name = document.getElementById('comment-name').value;
            const text = document.getElementById('comment-text').value;
            const rating = document.querySelector('input[name="rating"]:checked').value;

            if (name && text && rating) {
                const newComment = {
                    name,
                    text,
                    rating: parseInt(rating),
                    time: new Date().toLocaleString()
                };

                comments.push(newComment);
                updateCommentsList();
                updateAverageRating();
                resetCommentForm();
            } else {
                alert('모든 필드를 입력해주세요.');
            }
        }

        function updateCommentsList() {
            const commentsList = document.getElementById('comments-list');
            commentsList.innerHTML = '';

            comments.forEach((comment, index) => {
                const commentItem = document.createElement('li');
                commentItem.innerHTML = `
                    <span class="comment-name">${comment.name}</span>
                    <span class="comment-time">${comment.time}</span>
                    <span class="comment-text">${comment.text}</span>
                    <button class="delete-comment" onclick="deleteComment(${index})">삭제</button>
                `;
                commentsList.appendChild(commentItem);
            });
        }

        function updateAverageRating() {
            const averageRating = comments.reduce((acc, comment) => acc + comment.rating, 0) / comments.length;
            document.getElementById('average-rating').textContent = averageRating.toFixed(1);
            document.getElementById('average-rating-footer').textContent = averageRating.toFixed(1);
        }

        function deleteComment(index) {
            comments.splice(index, 1);
            updateCommentsList();
            updateAverageRating();
        }

        function resetCommentForm() {
            document.getElementById('comment-name').value = '';
            document.getElementById('comment-text').value = '';
            document.querySelector('input[name="rating"]:checked').checked = false;
        }
    </script>
</body>

</html>
